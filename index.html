<html>
<head>
<title>XKCD</title>
<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
<script src="http://code.responsivevoice.org/responsivevoice.js"></script>
</head>
<body>


<h1>Comic</h1>
<div id="xkcd"></div>

<button type="button" id="submit">Get a Random Comic</button>

<script>

$("#submit").click(function () {

    var myurl= "http://dynamic.xkcd.com/api-0/jsonp/comic";
    $.ajax({
        url : myurl,
        crossDomain : true,
        dataType : "jsonp",
        success : function(parsed_json) {
            var rand = Math.floor(Math.random() * (parsed_json.num + 1));

            $.ajax({
                url : myurl + "/" + rand,
                crossDomain : true,
                dataType : "jsonp",
                success : function (json) {
                    var read_text = json.transcript.split("[").join("").split("]").join("").split(":").join("").split("{").join("").split("}").join("").split("<").join("").split(">").join("");
                    // Should get rid of all conflicting special characters, I'm sure there's a better way of doing this -- may need to add more
                    
                    // buttons could be improved
                    $("#xkcd").html ("<img src = '" + json.img +"'>" + 
                        "<br><br><button type='button' id='play' onclick='play()'>Play</button><button type='button' id='pause' onclick='pause()'>Pause</button><br><br>"
                    );
                    responsiveVoice.speak(read_text); // probably better to not have this automatic
                }
            });
        }
    });
}); 

function play () {
    responsiveVoice.resume();
}

function pause () {
    responsiveVoice.pause();
}

</script>


</body>
</html>